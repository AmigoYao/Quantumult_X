# ─────────────────────────────
# 【AND 合并规则】——使用 URL-REGEX，用 lookahead 同时匹配各关键词或域后缀
URL-REGEX, (?i)^https?:\/\/(?=.*-ad-)(?=.*\.byteimg\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*-ttam-)(?=.*\.ibyteimg\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*ssdk-)(?=.*\.pangle\.io).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*pangolin)(?=.*\.sgsnssdk\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*lf)(?=.*-short\.bytetos\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*v)(?=.*-be-pack\.pglstatp-toutiao\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*sf)(?=.*-be-pack\.pglstatp-toutiao\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*s)(?=.*-fe-scm\.pglstatp-toutiao\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*sf)(?=.*-ttcdn-tos\.pstatp\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*sf)(?=.*-fe-tos\.pglstatp-toutiao\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*sf)(?=.*-static\.i18n-pglstatp\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*if)(?=.*-cdn-tos\.bytescm\.com).*, reject

# ─────────────────────────────
# 【“误杀”规则】
URL-REGEX, (?i)^https?:\/\/(?=.*if)(?=.*-analytics\.bytescm\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*lf)(?=.*-analytics\.bytescm\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*lf)(?=.*-analytics\.bytescm\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*ads)(?=.*normal)(?=.*\.zijieapi\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*api)(?=.*-access-)(?=.*\.pangle\.io).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*api)(?=.*-log-)(?=.*\.pangle\.io).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*api)(?=.*-dual-event-)(?=.*\.pangle\.io).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*api)(?=.*pangolin)(?=.*\.sgsnssdk\.com).*, reject
URL-REGEX, (?i)^https?:\/\/(?=.*ads)(?=.*-normal-lq)(?=.*\.zijieapi\.com).*, reject

# ─────────────────────────────
# 【原生 URL-REGEX 规则】
URL-REGEX, ^http:\/\/p\d+-be-pack-sign\.pglstatp-toutiao\.com\/(ad-app-package|web\.business\.image)\/, reject

# ─────────────────────────────
# 【简单域名规则】
DOMAIN, mon.zijieapi.com, reject
DOMAIN, lf-ad-ies.bytecdn.cn, reject
DOMAIN, i.snssdk.com, reject
DOMAIN, is.snssdk.com, reject
DOMAIN, bds.snssdk.com, reject
DOMAIN, dm.bytedance.com, reject
DOMAIN, dm.pstatp.com, reject
DOMAIN, dm.toutiao.com, reject
DOMAIN, log.snssdk.com, reject
DOMAIN, s3a.pstatp.com, reject
DOMAIN, sdfp.snssdk.com, reject
DOMAIN, tosv.boe.byted.org, reject
DOMAIN, tosv.byted.org, reject
DOMAIN, extlog.snssdk.com, reject
DOMAIN, mssdk-bu.bytedance.com, reject
DOMAIN, toblog.ctobsnssdk.com, reject
DOMAIN, mssdk.volces.com, reject
DOMAIN, pangolin.snssdk.com, reject
DOMAIN, gromore.pangolin-sdk-toutiao.com, reject
DOMAIN, ether-pack.pangolin-sdk-toutiao.com, reject
DOMAIN-KEYWORD, -ad-sign.byteimg.com, reject
DOMAIN-KEYWORD, api-access.pangolin-sdk-toutiao, reject
DOMAIN-KEYWORD, log-api.pangolin-sdk-toutiao, reject
DOMAIN-KEYWORD, -ad.byteoversea.com, reject
DOMAIN-KEYWORD, video-cn.snssdk.com, reject
DOMAIN-KEYWORD, asiad.byteactivity, reject
DOMAIN, gdfp.gifshow.com, reject
DOMAIN, open.e.kuaishou.com, reject
DOMAIN-SUFFIX, adukwai.com, reject
DOMAIN, sdk.beizi.biz, reject
DOMAIN, mobads.baidu.com, reject
DOMAIN, mobads-logs.baidu.com, reject
DOMAIN, wn.pos.baidu.com, reject
DOMAIN, bgg.baidu.com, reject
DOMAIN, als.baidu.com, reject
DOMAIN, feed-image.baidu.com, reject
DOMAIN-SUFFIX, union.baidu.cn, reject
DOMAIN-SUFFIX, union.baidu.com, reject
DOMAIN, ios.bugly.qq.com, reject
DOMAIN, sdk.e.qq.com, reject
DOMAIN-SUFFIX, ugdtimg.com, reject
DOMAIN-SUFFIX, gdtimg.com, reject
DOMAIN-SUFFIX, gdt.qq.com, reject
DOMAIN-SUFFIX, openinstall.io, reject
DOMAIN, zxid-m.mobileservice.cn, reject
DOMAIN, cnlogs.umeng.com, reject
DOMAIN, errlog.umeng.com, reject
DOMAIN, errnewlog.umeng.com, reject
DOMAIN, ucc.umeng.com, reject
DOMAIN, ulogs.umeng.com, reject
DOMAIN, utoken.umeng.com, reject

# ─────────────────────────────
# 【原 [Rewrite] 里的请求屏蔽规则】
URL, ^https:\/\/richmanrules\.ksedt\.com\/serverConfig\/3\/adConfig\.json, reject
URL, ^https:\/\/gouche\.ksedt\.com\/config\/popup\/info$, reject
URL, ^https:\/\/richmanrules\.ksedt\.com\/intellectWaterfallBidding\/find$, reject
URL, ^https:\/\/op\.ksedt\.com\/jxedtLive\/liveIntroduceResource, reject
URL, ^https:\/\/richmanrules\.ksedt\.com\/intellectWaterfall\/find$, reject

# ─────────────────────────────
# 【HTTP 响应体处理】（删除指定 JSON 字段，须借助脚本）
# 请将下列 js 脚本保存为 removeAdKeys.js：
#
# -----------------------------------------------------------
# let obj = JSON.parse($response.body);
# delete obj.result.homead;
# delete obj.result.h5_promotion_page;
# delete obj.result.advert_interval;
# delete obj.result.abtest_h5url;
# delete obj.result.launchApp;
# delete obj.result.goucheConfig;
# delete obj.result.gouche;
# delete obj.result.mainLiveConfig;
# delete obj.result.discover;
# delete obj.result.adSdkSwitch4testPointVideo;
# delete obj.result.adSdkSwitch4simulationExam;
# delete obj.result.examPageLoadADSwitch;
# $done({body: JSON.stringify(obj)});
# -----------------------------------------------------------
URL, ^https:\/\/api\.ksedt\.com\/api\/config\/, script-response-body=removeAdKeys.js, requires-body=true

[mitm]
hostname = richmanrules.ksedt.com, gouche.ksedt.com, muses.ksedt.com, op.ksedt.com, api.ksedt.com
